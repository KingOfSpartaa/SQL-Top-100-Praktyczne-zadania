-- Wyświetl top 3 klientów o największej wartości zamówień w sumie.

SELECT customers.CustomerName, ROUND(SUM(products.Price*order_details.Quantity),2) AS AvgOrder FROM customers
JOIN orders ON customers.CustomerID = orders.CustomerID
JOIN order_details ON orders.OrderID = order_details.OrderID
JOIN products ON order_details.ProductID = products.ProductID
GROUP BY customers.CustomerName
ORDER BY AvgOrder DESC
LIMIT 3
